m.train<- m-m.cv
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ¸ Ğ¾Ğ±ÑƒÑ‡Ğ°ÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº
cv.obs <- c(sample((1:m)[-anom.obs], size=m.cv-la, replace=FALSE), anom.obs)
train.obs<-(1:m)[-cv.obs]
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
m <- nrow(X)
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° Â«Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…Â» Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğ¹
anom.obs<-(1:m)[y==1]
la <- length(anom.obs)
m.cv <- round(0.2*(m-la)) + la
m.train<- m-m.cv
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ¸ Ğ¾Ğ±ÑƒÑ‡Ğ°ÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº
cv.obs <- c(sample((1:m)[-anom.obs], size=m.cv-la, replace=FALSE), anom.obs)
train.obs<-(1:m)[-cv.obs]
# Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸
X.train<-X[train.obs,]
X.cv <-X[cv.obs,]
y.train<-y[train.obs]
y.cv <-y[cv.obs]
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
m <- nrow(X)
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° Â«Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…Â» Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğ¹
anom.obs<-(1:m)[y==1]
la <- length(anom.obs)
m.cv <- round(0.2*(m-la)) + la
m.train<- m-m.cv
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ¸ Ğ¾Ğ±ÑƒÑ‡Ğ°ÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº
cv.obs <- c(sample((1:m)[-anom.obs], size=m.cv-la, replace=FALSE), anom.obs)
train.obs<-(1:m)[-cv.obs]
# Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸
X.train <- X[train.obs,]
X.cv <- X[cv.obs,]
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
m <- nrow(X)
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° Â«Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…Â» Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğ¹
anom.obs<-(1:m)[y==1]
la <- length(anom.obs)
m.cv <- round(0.2*(m-la)) + la
m.train<- m-m.cv
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ¸ Ğ¾Ğ±ÑƒÑ‡Ğ°ÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº
cv.obs <- c(sample((1:m)[-anom.obs], size=m.cv-la, replace=FALSE), anom.obs)
train.obs<-(1:m)[-cv.obs]
# Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸
X.train <- X[train.obs,]
X.cv <- X[cv.obs,]
y.train<-y[train.obs,]
y.cv <-y[cv.obs,]
# Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
mu <-apply(X.train, 2, mean)
sigma <-apply(X.train, 2, sd)
# Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸Â»
p <-function(X,mu,sigma) {
m <-nrow(X); n <-ncol(X)
prob<-matrix(nrow=m,ncol=n)
for (j in 1:n) prob[,j] <-dnorm(X[,j],mu[j],sigma[j])
apply(prob, 1, prod)
}
# Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ĞµĞ¹Â»
prob.train<-p(X.train,mu,sigma)
prob.cv <-p(X.cv,mu,sigma)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps,fitStats(y.pred,y.cv)) )
}
dimnames(res)[[2]][1] <-"epsilon"# Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
# Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ½Ğ°Ğ¸Ğ±Ğ¾Ğ»ĞµĞµ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ ğœ€
j <-which.max(res[,"f1.score"])
eps<-res[j,"epsilon"]
# Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·
y.pred<-1*(prob.cv < eps)
?fitStats
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps,fitstats(y.pred,y.cv)) )
}
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
}
?fitstats
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
fitstats
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
}
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
install.packages("metafor")
library(metafor)
for (eps in seq(pr[1], pr[2], length = 1000)) {
library(metafor)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
}
library(metafor)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
}
dimnames(res)[[2]][1] <-"epsilon"# Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
# Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ½Ğ°Ğ¸Ğ±Ğ¾Ğ»ĞµĞµ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ ğœ€
j <-which.max(res[,"f1.score"])
eps<-res[j,"epsilon"]
# Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·
y.pred<-1*(prob.cv < eps)
plot(X)
plot(X$X, X$X.1)
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
m <- nrow(X)
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° Â«Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…Â» Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğ¹
anom.obs<-(1:m)[y==1]
la <- length(anom.obs)
m.cv <- round(0.2*(m-la)) + la
m.train<- m-m.cv
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ¸ Ğ¾Ğ±ÑƒÑ‡Ğ°ÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº
cv.obs <- c(sample((1:m)[-anom.obs], size=m.cv-la, replace=FALSE), anom.obs)
train.obs<-(1:m)[-cv.obs]
# Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸
X.train <- X[train.obs,]
X.cv <- X[cv.obs,]
y.train<-y[train.obs,]
y.cv <-y[cv.obs,]
# Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
mu <-apply(X.train, 2, mean)
sigma <-apply(X.train, 2, sd)
# Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸Â»
p <-function(X,mu,sigma) {
m <-nrow(X); n <-ncol(X)
prob<-matrix(nrow=m,ncol=n)
for (j in 1:n) prob[,j] <-dnorm(X[,j],mu[j],sigma[j])
apply(prob, 1, prod)
}
# Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ĞµĞ¹Â»
prob.train<-p(X.train,mu,sigma)
prob.cv <-p(X.cv,mu,sigma)
library(metafor)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
}
dimnames(res)[[2]][1] <-"epsilon"# Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
# Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ½Ğ°Ğ¸Ğ±Ğ¾Ğ»ĞµĞµ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ ğœ€
j <-which.max(res[,"f1.score"])
eps<-res[j,"epsilon"]
# Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·
y.pred<-1*(prob.cv < eps)
?fitstats
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
}
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
X
?fitstats
library(metafor)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
m <- nrow(X)
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° Â«Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…Â» Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğ¹
anom.obs<-(1:m)[y==1]
la <- length(anom.obs)
m.cv <- round(0.2*(m-la)) + la
m.train<- m-m.cv
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ¸ Ğ¾Ğ±ÑƒÑ‡Ğ°ÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº
cv.obs <- c(sample((1:m)[-anom.obs], size=m.cv-la, replace=FALSE), anom.obs)
train.obs<-(1:m)[-cv.obs]
# Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸
X.train <- X[train.obs,]
X.cv <- X[cv.obs,]
y.train<-y[train.obs,]
y.cv <-y[cv.obs,]
# Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
mu <-apply(X.train, 2, mean)
sigma <-apply(X.train, 2, sd)
# Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸Â»
p <-function(X,mu,sigma) {
m <-nrow(X); n <-ncol(X)
prob<-matrix(nrow=m,ncol=n)
for (j in 1:n) prob[,j] <-dnorm(X[,j],mu[j],sigma[j])
apply(prob, 1, prod)
}
# Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ĞµĞ¹Â»
prob.train<-p(X.train,mu,sigma)
prob.cv <-p(X.cv,mu,sigma)
library(metafor)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
}
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
m <- nrow(X)
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° Â«Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…Â» Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğ¹
anom.obs<-(1:m)[y==1]
la <- length(anom.obs)
m.cv <- round(0.2*(m-la)) + la
m.train<- m-m.cv
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ¸ Ğ¾Ğ±ÑƒÑ‡Ğ°ÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº
cv.obs <- c(sample((1:m)[-anom.obs], size=m.cv-la, replace=FALSE), anom.obs)
train.obs<-(1:m)[-cv.obs]
# Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸
X.train <- X[train.obs,]
X.cv <- X[cv.obs,]
y.train<-y[train.obs,]
y.cv <-y[cv.obs,]
# Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
mu <-apply(X.train, 2, mean)
sigma <-apply(X.train, 2, sd)
# Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸Â»
p <-function(X,mu,sigma) {
m <-nrow(X); n <-ncol(X)
prob<-matrix(nrow=m,ncol=n)
for (j in 1:n) prob[,j] <-dnorm(X[,j],mu[j],sigma[j])
apply(prob, 1, prod)
}
# Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ĞµĞ¹Â»
prob.train<-p(X.train,mu,sigma)
prob.cv <-p(X.cv,mu,sigma)
library(metafor)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitStats(y.pred, y.cv)))
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
m <- nrow(X)
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° Â«Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…Â» Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğ¹
anom.obs<-(1:m)[y==1]
la <- length(anom.obs)
m.cv <- round(0.2*(m-la)) + la
m.train<- m-m.cv
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ¸ Ğ¾Ğ±ÑƒÑ‡Ğ°ÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº
cv.obs <- c(sample((1:m)[-anom.obs], size=m.cv-la, replace=FALSE), anom.obs)
train.obs<-(1:m)[-cv.obs]
# Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸
X.train <- X[train.obs,]
X.cv <- X[cv.obs,]
y.train<-y[train.obs,]
y.cv <-y[cv.obs,]
# Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
mu <-apply(X.train, 2, mean)
sigma <-apply(X.train, 2, sd)
# Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸Â»
p <-function(X,mu,sigma) {
m <-nrow(X); n <-ncol(X)
prob<-matrix(nrow=m,ncol=n)
for (j in 1:n) prob[,j] <-dnorm(X[,j],mu[j],sigma[j])
apply(prob, 1, prod)
}
# Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ĞµĞ¹Â»
prob.train<-p(X.train,mu,sigma)
prob.cv <-p(X.cv,mu,sigma)
library(metafor)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitStats(y.pred, y.cv)))
}
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
m <- nrow(X)
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° Â«Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…Â» Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğ¹
anom.obs<-(1:m)[y==1]
la <- length(anom.obs)
m.cv <- round(0.2*(m-la)) + la
m.train<- m-m.cv
# Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ¸ Ğ¾Ğ±ÑƒÑ‡Ğ°ÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº
cv.obs <- c(sample((1:m)[-anom.obs], size=m.cv-la, replace=FALSE), anom.obs)
train.obs<-(1:m)[-cv.obs]
# Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸
X.train <- X[train.obs,]
X.cv <- X[cv.obs,]
y.train<-y[train.obs,]
y.cv <-y[cv.obs,]
# Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
mu <-apply(X.train, 2, mean)
sigma <-apply(X.train, 2, sd)
# Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸Â»
p <-function(X,mu,sigma) {
m <-nrow(X); n <-ncol(X)
prob<-matrix(nrow=m,ncol=n)
for (j in 1:n) prob[,j] <-dnorm(X[,j],mu[j],sigma[j])
apply(prob, 1, prod)
}
# Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Â«Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ĞµĞ¹Â»
prob.train<-p(X.train,mu,sigma)
prob.cv <-p(X.cv,mu,sigma)
library(metafor)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitstatistics(y.pred, y.cv)))
}
library(metafor)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitstats(y.pred, y.cv)))
}
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1, labels = y)
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
text(X$X,X$X.1,labels = y
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
text(X$X,X$X.1,labels = y)
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1, type = "n")
text(X$X,X$X.1,labels = y)
train <- read.csv('C:\\Users\\asedov001\\Documents\\CMF\\Anomaly Detection\\AD_comp_train.csv')
X <- train[c('X', 'X.1')]
y <- train['y']
plot(X$X, X$X.1)
?which
?where
y1 <- y[y$y!=0]
y1 <- y[y!=0]
y1
train
plot (train$X, train$X.1, col=ifelse(train$y=1, 'black', 'red'))
plot (train$X, train$X.1, col=ifelse(train$y<1, 'black', 'red'))
plot (train$X, train$X.1, col=ifelse(train$y<1, 'black', 'red'), pch = 19)
plot (train$X, train$X.1, col=ifelse(train$y<1, 'black', 'red'), pch = 10)
plot (train$X, train$X.1, col=ifelse(train$y<1, 'black', 'red'), pch = 15)
plot (train$X, train$X.1, col=ifelse(train$y<1, 'black', 'red'))
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
fitStats<-function(y,y.pred) {
...
if (precision + recall == 0) f1.score <-0
stat <-c(accuracy,precision,recall,f1.score)
names(stat) <-c("accuracy","precision","recall","f1.score")
stat
}
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitStats(y.pred, y.cv)))
}
dimnames(res)[[2]][1] <-"epsilon"# Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
# Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ½Ğ°Ğ¸Ğ±Ğ¾Ğ»ĞµĞµ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ ğœ€
j <-which.max(res[,"f1.score"])
eps<-res[j,"epsilon"]
# Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·
y.pred<-1*(prob.cv < eps)
pr<-range(prob.cv) # Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ ğœ€
res <-NULL# Ğ² Ğ½ĞµÑ‘ Ğ±ÑƒĞ´ÑƒÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒÑÑ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
# Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ÑƒÑÑ‰ĞµĞ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
# Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¸ ğœ€Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµĞ¼ ĞµĞ³Ğ¾ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ğ¼
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, eps)
}
dimnames(res)[[2]][1] <-"epsilon"# Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
# Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ½Ğ°Ğ¸Ğ±Ğ¾Ğ»ĞµĞµ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ ğœ€
j <-which.max(res[,"f1.score"])
eps<-res[j,"epsilon"]
# Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·
y.pred<-1*(prob.cv < eps)
fitStats<-function(y,y.pred) {
precision <- posPredValue(y.pred, y)
recall <- sensitivity(y.pred, y)
f1.score <- (2 * precision * recall) / (precision + recall)
if (precision + recall == 0) f1.score <-0
stat <-c(precision,recall,f1.score)
names(stat) <-c(precision","recall","f1.score")
stat
}
fitStats<-function(y,y.pred) {
precision <- posPredValue(y.pred, y)
recall <- sensitivity(y.pred, y)
f1.score <- (2 * precision * recall) / (precision + recall)
if (precision + recall == 0) f1.score <-0
stat <-c(accuracy,precision,recall,f1.score)
names(stat) <-c("accuracy","precision","recall","f1.score")
stat
}
fitStats<-function(y,y.pred) {
precision <- posPredValue(y.pred, y)
recall <- sensitivity(y.pred, y)
f1.score <- (2 * precision * recall) / (precision + recall)
if (precision + recall == 0) f1.score <-0
stat <-c(precision,recall,f1.score)
names(stat) <-c("precision","recall","f1.score")
stat
}
for (eps in seq(pr[1], pr[2], length = 1000)) {
y.pred<-1*(prob.cv < eps)
res <-rbind(res, c(eps, fitStats(y.pred, y.cv)))
}
?posPredValue
library(caret)
fitStats<-function(y,y.pred) {
precision <- posPredValue(y.pred, y)
recall <- sensitivity(y.pred, y)
f1.score <- (2 * precision * recall) / (precision + recall)
if (precision + recall == 0) f1.score <-0
stat <-c(precision,recall,f1.score)
names(stat) <-c("precision","recall","f1.score")
stat
}
install.packages("caret")
library(caret)
fitStats<-function(y,y.pred) {
precision <- posPredValue(y.pred, y)
recall <- sensitivity(y.pred, y)
f1.score <- (2 * precision * recall) / (precision + recall)
if (precision + recall == 0) f1.score <-0
stat <-c(precision,recall,f1.score)
names(stat) <-c("precision","recall","f1.score")
stat
}
?sensitivity
install.packages("caretEnsemble")
library(caret)
fitStats<-function(y,y.pred) {
precision <- posPredValue(y.pred, y)
recall <- sensitivity(y.pred, y)
f1.score <- (2 * precision * recall) / (precision + recall)
if (precision + recall == 0) f1.score <-0
stat <-c(precision,recall,f1.score)
names(stat) <-c("precision","recall","f1.score")
stat
}
install.packages("caret")
library(caret)
install.packages("caret")
install.packages("caret")
install.packages("caret")
?install.packages
install.packages("caret")
library("caretEnsemble", lib.loc="~/R/win-library/3.3")
install.packages("caret")
